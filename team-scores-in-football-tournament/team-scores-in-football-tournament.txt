// LeetCode: Team Scores in Football Tournament (team-scores-in-football-tournament)
// Submission ID: 1742097599
// Language: mysql
// Timestamp (UTC): 2025-08-20T13:48:07Z

# Write your MySQL query statement below
select t.team_id,t.team_name,
sum(case when t.team_id=m.host_team and m.host_goals>m.guest_goals then 3
         when t.team_id=m.guest_team and m.host_goals<m.guest_goals then 3
         when t.team_id=m.host_team and m.host_goals=m.guest_goals then 1
         when t.team_id=m.guest_team and m.host_goals=m.guest_goals then 1
        else 0 
        end) as num_points
from Teams t
left join Matches m
on t.team_id=m.host_team or t.team_id=m.guest_team
group by t.team_id,t.team_name
order by num_points desc,t.team_id